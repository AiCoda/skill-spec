{# 中文 SKILL.md 模板 - Skill-Spec #}
{# 版本: 2.0.0 - 符合 Anthropic 格式规范 #}
---
name: "{{ skill.name }}"
description: "{{ skill.purpose }}{% if triggers %} 适用场景: {{ triggers | join(' | ') }}{% endif %}"
---

# {{ skill.name | replace('-', ' ') | title }}

## 描述

{{ skill.purpose }}

{% if non_goals %}
**本技能不会:**
{% for goal in non_goals %}
- {{ goal }}
{% endfor %}
{% endif %}

{% if context and context.scenarios %}
## 使用场景

在以下情况下使用本技能:
{% for scenario in context.scenarios %}
- {{ scenario.trigger }}
{% endfor %}

{% endif %}
{% if preconditions %}
**不适用于:**
{% for prereq in preconditions %}
- 前置条件不满足: {{ prereq }}
{% endfor %}
{% endif %}

## 使用说明

### 输入要求

{% if inputs %}
{% for inp in inputs %}
{{ loop.index }}. **{{ inp.name }}** ({{ '必填' if inp.required else '选填' }}): {{ inp.description | default('') }}
   - 类型: `{{ inp.type }}`
{% if inp.constraints %}   - 约束: {{ inp.constraints | join(', ') }}{% endif %}
{% if inp.domain and inp.domain.type == 'enum' %}   - 可选值: {{ inp.domain.values | join(', ') }}{% endif %}
{% if inp.default is defined %}   - 默认值: `{{ inp.default }}`{% endif %}
{% endfor %}
{% endif %}

### 执行流程

{% if steps %}
{% for step in steps %}
{{ loop.index }}. {{ step.action }}{% if step.output %} -> `{{ step.output }}`{% endif %}
{% endfor %}
{% endif %}

{% if decision_rules %}
### 决策规则

| 条件 | 动作 |
|------|------|
{% for rule in decision_rules %}
{% if rule.when is not true %}
| `{{ rule.when }}` | {{ rule.then.action | default(rule.then.path | default('')) }} |
{% endif %}
{% endfor %}
{% endif %}

### 输出格式

```json
{{ output_contract.schema | tojson(indent=2) }}
```

{% if examples %}
## 示例

{% for example in examples %}
### 示例 {{ loop.index }}: {{ example.name }}

**输入:**
```json
{{ example.input | tojson(indent=2) }}
```

**输出:**
```json
{{ example.output | tojson(indent=2) }}
```

{% if example.explanation %}
{{ example.explanation }}
{% endif %}

{% endfor %}
{% endif %}

{% if edge_cases %}
## 边界情况

| 情况 | 预期行为 |
|------|----------|
{% for ec in edge_cases %}
| {{ ec.case }}{% if ec.description %} - {{ ec.description }}{% endif %} | {{ ec.expected.status | default('') }}{% if ec.expected.code %} (`{{ ec.expected.code }}`){% endif %} |
{% endfor %}
{% endif %}

## 限制

{% if non_goals %}
{% for goal in non_goals %}
{{ loop.index }}. {{ goal }}
{% endfor %}
{% else %}
1. 仅支持静态分析 - 无法执行或评估运行时行为
2. 对某些编程语言的支持可能有限
3. 无法访问外部系统或仓库
{% endif %}

{% if failure_modes %}
## 错误代码

| 代码 | 可重试 | 描述 |
|------|--------|------|
{% for fm in failure_modes %}
| `{{ fm.code }}` | {{ '是' if fm.retryable else '否' }} | {{ fm.description | default('') }} |
{% endfor %}
{% endif %}

{% if context and context.works_with %}
## 相关技能

{% for ref in context.works_with %}
- **{{ ref.skill }}**: {{ ref.reason }}
{% endfor %}
{% endif %}
